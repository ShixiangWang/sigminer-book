<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Target visualization | Extract, Analyze and Visualize Mutational Signatures with Sigminer</title>
<meta name="author" content="Shixiang Wang, PhD (Sun Yat-sen University Cancer Center)">
<meta name="author" content="Xue-Song Liu, PhD (ShanghaiTech University)">
<meta name="description" content='5.1 CopyNumber object  5.1.1 Profile show_cn_profile(cn, nrow = 2, ncol = 1) show_cn_circos(cn, samples = 1)   5.1.2 Distribution show_cn_distribution(cn, mode = "ld") show_cn_distribution(cn,...'>
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 5 Target visualization | Extract, Analyze and Visualize Mutational Signatures with Sigminer">
<meta property="og:type" content="book">
<meta property="og:description" content='5.1 CopyNumber object  5.1.1 Profile show_cn_profile(cn, nrow = 2, ncol = 1) show_cn_circos(cn, samples = 1)   5.1.2 Distribution show_cn_distribution(cn, mode = "ld") show_cn_distribution(cn,...'>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Target visualization | Extract, Analyze and Visualize Mutational Signatures with Sigminer">
<meta name="twitter:description" content='5.1 CopyNumber object  5.1.1 Profile show_cn_profile(cn, nrow = 2, ncol = 1) show_cn_circos(cn, samples = 1)   5.1.2 Distribution show_cn_distribution(cn, mode = "ld") show_cn_distribution(cn,...'>
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.19/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Extract, Analyze and Visualize Mutational Signatures with Sigminer</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">📖 Introduction</a></li>
<li class="book-part">Part I: Background and Prerequisite</li>
<li><a class="" href="mutsig-intro.html"><span class="header-section-number">1</span> Mutational signatures</a></li>
<li><a class="" href="prerequisite.html"><span class="header-section-number">2</span> Package prerequisite and installation</a></li>
<li class="book-part">Part II: Workflows</li>
<li><a class="" href="basic-workflow.html"><span class="header-section-number">3</span> Basic analysis workflow</a></li>
<li><a class="" href="analysis-supps.html"><span class="header-section-number">4</span> Analysis supplements</a></li>
<li><a class="active" href="target-vis.html"><span class="header-section-number">5</span> Target visualization</a></li>
<li class="book-part">Part III: Miscellaneous topics</li>
<li><a class="" href="universal-analysis.html"><span class="header-section-number">6</span> Universal analysis</a></li>
<li><a class="" href="subtype-prediction.html"><span class="header-section-number">7</span> Subtype prediction</a></li>
<li><a class="" href="sigflow.html"><span class="header-section-number">8</span> Sigflow pipeline</a></li>
<li><a class="" href="datasets.html"><span class="header-section-number">9</span> Datasets</a></li>
<li><a class="" href="convert.html"><span class="header-section-number">10</span> SBS signature conversion</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="target-vis" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Target visualization<a class="anchor" aria-label="anchor" href="#target-vis"><i class="fas fa-link"></i></a>
</h1>
<div id="copynumber-object" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> <code>CopyNumber</code> object<a class="anchor" aria-label="anchor" href="#copynumber-object"><i class="fas fa-link"></i></a>
</h2>
<div id="profile" class="section level3" number="5.1.1">
<h3>
<span class="header-section-number">5.1.1</span> Profile<a class="anchor" aria-label="anchor" href="#profile"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cn_profile.html">show_cn_profile</a></span><span class="op">(</span><span class="va">cn</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-66-1.png" width="95%"></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cn_circos.html">show_cn_circos</a></span><span class="op">(</span><span class="va">cn</span>, samples <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-67-1.png" width="95%"></div>
</div>
<div id="distribution" class="section level3" number="5.1.2">
<h3>
<span class="header-section-number">5.1.2</span> Distribution<a class="anchor" aria-label="anchor" href="#distribution"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cn_distribution.html">show_cn_distribution</a></span><span class="op">(</span><span class="va">cn</span>, mode <span class="op">=</span> <span class="st">"ld"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-68-1.png" width="95%"></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cn_distribution.html">show_cn_distribution</a></span><span class="op">(</span><span class="va">cn</span>, mode <span class="op">=</span> <span class="st">"cd"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-69-1.png" width="95%"></div>
</div>
</div>
<div id="signature-object" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> <code>Signature</code> object<a class="anchor" aria-label="anchor" href="#signature-object"><i class="fas fa-link"></i></a>
</h2>
<p><code>Signature</code> is a core object in <strong>sigminer</strong>, it stores signatures and their exposures. Here we show how to plot signature profile and exposure profile. The result plots are basically <strong>ggplot</strong> based, so they can be further edited by your custom operations with <strong>ggplot</strong> grammar.</p>
<div id="operate-signature" class="section level3" number="5.2.1">
<h3>
<span class="header-section-number">5.2.1</span> Operate <code>Signature</code><a class="anchor" aria-label="anchor" href="#operate-signature"><i class="fas fa-link"></i></a>
</h3>
<p>The result of <code><a href="https://rdrr.io/pkg/sigminer/man/sig_extract.html">sig_extract()</a></code> or <code><a href="https://rdrr.io/pkg/sigminer/man/sig_auto_extract.html">sig_auto_extract()</a></code> is a <code>list</code> with <code>Signature</code> class. You can use <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> or use operation function to obtain the data stored in it.</p>
<p>To get the signature matrix:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Or mt_sig2$Signature</span>
<span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/sig_operation.html">sig_signature</a></span><span class="op">(</span><span class="va">mt_sig2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>
<span class="co">##                Sig1        Sig2         Sig3</span>
<span class="co">## A[T&gt;C]A 0.008632350 0.012998315 0.0027599263</span>
<span class="co">## C[T&gt;C]A 0.005765919 0.007065285 0.0007488439</span>
<span class="co">## G[T&gt;C]A 0.013026940 0.004318256 0.0009744887</span>
<span class="co">## T[T&gt;C]A 0.004725412 0.004544973 0.0012188315</span>
<span class="co">## A[C&gt;T]A 0.004464683 0.017714329 0.0063508777</span></code></pre></div>
<p>To get signature exposure matrix:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Or mt_sig$Exposure</span>
<span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/sig_operation.html">sig_exposure</a></span><span class="op">(</span><span class="va">mt_sig2</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="co">##      TCGA-A1-A0SH-01A-11D-A099-09 TCGA-A2-A04N-01A-11D-A10Y-09</span>
<span class="co">## Sig1                     31.66886                    16.840245</span>
<span class="co">## Sig2                     17.46182                    31.616889</span>
<span class="co">## Sig3                     86.66939                     3.141982</span>
<span class="co">##      TCGA-A2-A0CP-01A-11W-A050-09 TCGA-A2-A0EP-01A-52D-A22X-09</span>
<span class="co">## Sig1                    23.365351                   14.2720018</span>
<span class="co">## Sig2                    22.090623                    0.7626465</span>
<span class="co">## Sig3                     4.622696                    6.8293109</span>
<span class="co">##      TCGA-A2-A0EV-01A-11W-A050-09</span>
<span class="co">## Sig1                     35.06135</span>
<span class="co">## Sig2                     25.81997</span>
<span class="co">## Sig3                     17.46720</span></code></pre></div>
<p><code><a href="https://rdrr.io/pkg/sigminer/man/get_sig_exposure.html">get_sig_exposure()</a></code> may be more useful, it can be used to return a <code>data.frame</code> and set an exposure threshold.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/get_sig_exposure.html">get_sig_exposure</a></span><span class="op">(</span><span class="va">mt_sig2</span><span class="op">)</span>
<span class="co">##                            sample          Sig1          Sig2          Sig3</span>
<span class="co">##   1: TCGA-A1-A0SH-01A-11D-A099-09  3.166886e+01  1.746182e+01  8.666939e+01</span>
<span class="co">##   2: TCGA-A2-A04N-01A-11D-A10Y-09  1.684024e+01  3.161689e+01  3.141982e+00</span>
<span class="co">##   3: TCGA-A2-A0CP-01A-11W-A050-09  2.336535e+01  2.209062e+01  4.622696e+00</span>
<span class="co">##   4: TCGA-A2-A0EP-01A-52D-A22X-09  1.427200e+01  7.626465e-01  6.829311e+00</span>
<span class="co">##   5: TCGA-A2-A0EV-01A-11W-A050-09  3.506135e+01  2.581997e+01  1.746720e+01</span>
<span class="co">##   6: TCGA-A2-A0SX-01A-12D-A099-09  1.799211e+01  1.298242e+01  9.594181e+00</span>
<span class="co">##   7: TCGA-A2-A0T7-01A-21D-A099-09  5.268863e+00  2.400288e+01  4.272836e-18</span>
<span class="co">##   8: TCGA-A2-A0YF-01A-21D-A10G-09  1.304188e+01  2.883374e+01 3.092878e-219</span>
<span class="co">##   9: TCGA-A2-A25F-01A-11D-A167-09  8.954687e+00 2.124482e-322  0.000000e+00</span>
<span class="co">##  10: TCGA-A2-A3XW-01A-11D-A23C-09  9.992137e+00  8.307369e+00  5.585825e-01</span>
<span class="co">##  11: TCGA-A2-A4S1-01A-21D-A25Q-09  6.855788e+01  2.385549e+01  4.218989e+00</span>
<span class="co">##  12: TCGA-A7-A0D9-01A-31W-A071-09  2.789866e+01  1.612393e+01  1.610362e+01</span>
<span class="co">##  13: TCGA-A7-A13F-01A-11D-A12Q-09 2.218617e-143  7.233318e+01  1.015108e+01</span>
<span class="co">##  14: TCGA-A7-A5ZV-01A-11D-A28B-09  1.707878e+02  4.282286e+01  3.607406e+01</span>
<span class="co">##  15: TCGA-A8-A06P-01A-11W-A019-09  2.143307e+01  1.954021e+01  3.290205e+00</span>
<span class="co">##  16: TCGA-A8-A076-01A-21W-A019-09  3.186376e+01  4.840680e+01  1.219314e+01</span>
<span class="co">##  17: TCGA-A8-A07W-01A-11W-A019-09  9.941026e+01  4.891769e+01  2.093785e+01</span>
<span class="co">##  18: TCGA-A8-A084-01A-21W-A019-09  1.860221e+01  3.549728e+01  2.878729e+01</span>
<span class="co">##  19: TCGA-A8-A08S-01A-11W-A050-09  1.705885e+01  4.703995e+01  2.595490e-14</span>
<span class="co">##  20: TCGA-A8-A09G-01A-21W-A019-09  3.971052e-87  1.640886e+01  3.009882e+02</span>
<span class="co">##  21: TCGA-A8-A0A4-01A-11W-A019-09  1.266228e+01  2.461204e+01  8.855363e-01</span>
<span class="co">##  22: TCGA-A8-A0AB-01A-11W-A050-09  2.161191e+01  1.136710e+01  4.588114e+00</span>
<span class="co">##  23: TCGA-AC-A2B8-01A-11D-A17D-09 2.033307e-122  2.098482e+01  1.038001e+02</span>
<span class="co">##  24: TCGA-AC-A2FO-01A-11D-A17W-09  8.304307e+00  5.968893e+00  1.455197e+01</span>
<span class="co">##  25: TCGA-AC-A3YI-01A-21D-A23C-09  1.166597e+01  8.174477e+00 3.737224e-304</span>
<span class="co">##  26: TCGA-AC-A8OS-01A-12D-A41F-09  3.226793e+01  2.847194e+01  1.852043e+01</span>
<span class="co">##  27: TCGA-AN-A0FK-01A-11W-A050-09 4.675220e-136  5.434698e+01 3.013800e-322</span>
<span class="co">##  28: TCGA-AN-A0FT-01A-11W-A050-09  2.329794e+01  6.405417e+01  3.668331e+01</span>
<span class="co">##  29: TCGA-AN-A0XO-01A-11D-A10G-09  1.810539e+01  1.288004e+01  1.156616e+01</span>
<span class="co">##  30: TCGA-AO-A1KS-01A-11D-A13L-09  1.471045e-15  3.636395e+01  1.884661e+01</span>
<span class="co">##  31: TCGA-AQ-A54O-01A-11D-A25Q-09 1.998371e-110  2.479216e+01  4.475523e-01</span>
<span class="co">##  32: TCGA-AQ-A7U7-01A-22D-A351-09  1.357465e+01  1.450933e+01  7.322714e+01</span>
<span class="co">##  33: TCGA-AR-A0TP-01A-11D-A099-09  5.700843e+01  7.538727e+00  5.532723e+00</span>
<span class="co">##  34: TCGA-AR-A0U3-01A-11D-A10G-09  1.566172e+01  2.445972e+01  0.000000e+00</span>
<span class="co">##  35: TCGA-AR-A1AH-01A-11D-A12B-09  9.313898e+01  1.664222e+01  7.946685e+00</span>
<span class="co">##  36: TCGA-AR-A1AJ-01A-21D-A12Q-09  7.732463e+00  2.359439e+01  2.272694e+01</span>
<span class="co">##  37: TCGA-AR-A1AN-01A-11D-A12Q-09  1.050960e-43  2.694093e+01  6.145010e+00</span>
<span class="co">##  38: TCGA-AR-A24N-01A-11D-A167-09  1.894249e+01  2.390942e+01  4.230534e+00</span>
<span class="co">##  39: TCGA-AR-A252-01A-11D-A167-09  6.071164e+00  1.270826e+01 3.013800e-322</span>
<span class="co">##  40: TCGA-AR-A2LL-01A-11D-A17W-09  1.466495e+01  2.258277e+01 3.013800e-322</span>
<span class="co">##  41: TCGA-AR-A2LO-01A-31D-A18P-09  1.403040e+01  2.614092e+00  3.231288e+00</span>
<span class="co">##  42: TCGA-B6-A0IE-01A-11W-A050-09  2.010311e+01  1.958096e+01  2.610397e+00</span>
<span class="co">##  43: TCGA-B6-A0IM-01A-11W-A050-09  2.075968e+01  1.952527e+01 3.513353e-125</span>
<span class="co">##  44: TCGA-B6-A0IP-01A-11D-A045-09  1.416886e+01  3.635690e+01  7.257260e-01</span>
<span class="co">##  45: TCGA-B6-A0RV-01A-11D-A099-09 2.766768e-322  1.812611e+01  4.845000e+01</span>
<span class="co">##  46: TCGA-B6-A0WZ-01A-11D-A10G-09  7.381598e+00  6.159155e+00  8.056780e+01</span>
<span class="co">##  47: TCGA-B6-A0X1-01A-11D-A10G-09  4.774611e+01  2.081434e+01  2.141664e+01</span>
<span class="co">##  48: TCGA-B6-A1KC-01B-11D-A159-09  1.224477e+01  2.235468e+01  6.975468e-01</span>
<span class="co">##  49: TCGA-B6-A401-01A-11D-A23C-09  1.104261e+01  1.933849e+01  8.745074e-02</span>
<span class="co">##  50: TCGA-B6-A40C-01A-11D-A23C-09  1.734504e+01  3.269065e+01  2.469909e+00</span>
<span class="co">##  51: TCGA-BH-A0AV-01A-31D-A10Y-09  6.543456e+01  3.624715e+00  1.540206e+01</span>
<span class="co">##  52: TCGA-BH-A0BT-01A-11D-A12Q-09  6.306036e+00  3.814813e+01  2.720250e+00</span>
<span class="co">##  53: TCGA-BH-A0DL-01A-11D-A10Y-09  2.894770e+01  6.846251e+01  2.895576e+01</span>
<span class="co">##  54: TCGA-BH-A0DO-01B-11D-A12B-09  9.969784e+00  1.446941e+01  5.233825e+00</span>
<span class="co">##  55: TCGA-BH-A0DT-01A-21D-A12B-09  2.462409e+00  1.154792e+01  1.819875e+00</span>
<span class="co">##  56: TCGA-BH-A0GY-01A-11W-A071-09  1.621720e+01  2.581025e+01 4.526295e-276</span>
<span class="co">##  57: TCGA-BH-A0H6-01A-21W-A071-09  1.082937e+01  1.579577e+01 4.340126e-293</span>
<span class="co">##  58: TCGA-BH-A18K-01A-11D-A12B-09  2.097981e+01  1.462527e+01  3.631013e+01</span>
<span class="co">##  59: TCGA-BH-A1FU-01A-11D-A14G-09  6.277453e+01  2.878294e+01  2.394254e+01</span>
<span class="co">##  60: TCGA-BH-A202-01A-11D-A14K-09  6.871836e+00  2.020375e+01  3.928063e-01</span>
<span class="co">##  61: TCGA-BH-A5IZ-01A-11D-A27P-09  1.246154e+02  2.209061e+01  3.537264e+01</span>
<span class="co">##  62: TCGA-BH-A6R8-01A-21D-A33E-09  1.164019e+01  2.430453e+01  5.236235e+00</span>
<span class="co">##  63: TCGA-BH-A8G0-01A-11D-A351-09 2.597199e-102  2.048118e+01  0.000000e+00</span>
<span class="co">##  64: TCGA-C8-A131-01A-11D-A10Y-09  2.590583e+01  4.370584e+01  3.640790e+00</span>
<span class="co">##  65: TCGA-D8-A147-01A-11D-A10Y-09  1.161776e+02  5.212590e+00  7.266037e+01</span>
<span class="co">##  66: TCGA-D8-A1JG-01B-11D-A13L-09  8.471905e+01  6.345205e+01  2.060929e+01</span>
<span class="co">##  67: TCGA-D8-A1JH-01A-11D-A188-09  9.663174e+00  1.327837e+01  7.873566e-01</span>
<span class="co">##  68: TCGA-D8-A1JJ-01A-31D-A14K-09  1.133959e+01  3.674766e+01  5.104066e+01</span>
<span class="co">##  69: TCGA-D8-A1JT-01A-31D-A13L-09  2.090274e+01  2.128976e+01  0.000000e+00</span>
<span class="co">##  70: TCGA-D8-A1JU-01A-11D-A13L-09  9.091898e+00  1.071928e+01  2.713162e-39</span>
<span class="co">##  71: TCGA-D8-A1X7-01A-11D-A14K-09  1.294633e+01  1.525286e+01  3.413301e+00</span>
<span class="co">##  72: TCGA-D8-A1X8-01A-11D-A14K-09  1.448665e+01  1.581697e+01  2.266142e+00</span>
<span class="co">##  73: TCGA-D8-A1XL-01A-11D-A14K-09  7.589129e+01  2.279192e+01  7.395903e+00</span>
<span class="co">##  74: TCGA-D8-A27V-01A-12D-A17D-09  3.423782e-80  3.137792e+01  1.880720e+02</span>
<span class="co">##  75: TCGA-E2-A108-01A-13D-A10M-09  3.632974e+01  1.314449e+01  1.338054e+02</span>
<span class="co">##  76: TCGA-E2-A10F-01A-11D-A10M-09 2.766768e-322  2.414387e+01  5.123782e+00</span>
<span class="co">##  77: TCGA-E2-A14T-01A-11D-A10Y-09  1.661234e+01  1.927166e+01  7.476472e+00</span>
<span class="co">##  78: TCGA-E2-A152-01A-11D-A12B-09  1.171920e-21  1.987249e+01  1.445783e+02</span>
<span class="co">##  79: TCGA-E2-A15D-01A-11D-A10Y-09  1.162797e+01  2.447046e+01  8.456098e-02</span>
<span class="co">##  80: TCGA-E2-A15L-01A-11D-A12B-09 6.564409e-266  3.705154e+01  7.227903e+00</span>
<span class="co">##  81: TCGA-E2-A1BD-01A-11D-A12Q-09  1.347320e+01  2.835382e+01  7.608654e-02</span>
<span class="co">##  82: TCGA-E2-A1IH-01A-11D-A188-09  1.607014e+01  2.769621e+01  4.043042e+01</span>
<span class="co">##  83: TCGA-E2-A1II-01A-11D-A142-09  3.287852e+01  1.507799e+00 3.013800e-322</span>
<span class="co">##  84: TCGA-E2-A1IJ-01A-11D-A142-09  6.353640e+00  1.340142e+01 1.066686e-292</span>
<span class="co">##  85: TCGA-E2-A1L6-01A-11D-A13L-09  2.115141e-46  2.802838e+01  7.333578e-63</span>
<span class="co">##  86: TCGA-E2-A9RU-01A-11D-A41F-09  2.027101e+01  6.333655e+01  2.100747e+01</span>
<span class="co">##  87: TCGA-E9-A1NE-01A-21D-A14K-09  4.944191e+01  5.057375e+00  6.071713e+00</span>
<span class="co">##  88: TCGA-E9-A22A-01A-11D-A159-09  1.889911e+01  7.690585e+00  1.009118e+01</span>
<span class="co">##  89: TCGA-E9-A22E-01A-11D-A159-09  9.223014e+01  1.041757e+01  4.455073e+01</span>
<span class="co">##  90: TCGA-E9-A3QA-01A-61D-A228-09  3.257514e+01  4.527811e+00  2.793381e+01</span>
<span class="co">##  91: TCGA-E9-A5FL-01A-11D-A27P-09  9.051438e+01  1.322275e+01  2.905100e+01</span>
<span class="co">##  92: TCGA-EW-A1PA-01A-11D-A142-09  1.887140e+01  1.923060e+01  4.231605e+00</span>
<span class="co">##  93: TCGA-EW-A1PH-01A-11D-A14K-09  2.347811e+01  3.271478e+01  8.143171e+00</span>
<span class="co">##  94: TCGA-GM-A2DB-01A-31D-A19Y-09  8.399491e+01  3.122550e+01  1.350770e+01</span>
<span class="co">##  95: TCGA-LD-A9QF-01A-32D-A41F-09  1.456385e+01  2.328753e+01  1.357230e+00</span>
<span class="co">##  96: TCGA-LL-A5YP-01A-21D-A28B-09  7.878814e+01  6.897847e+00  2.056396e+01</span>
<span class="co">##  97: TCGA-LL-A73Z-01A-11D-A32I-09  2.436630e+01  2.686392e+01  2.538904e+00</span>
<span class="co">##  98: TCGA-OL-A5RY-01A-21D-A28B-09  7.360216e+00  7.184128e+00  1.360407e+00</span>
<span class="co">##  99: TCGA-PE-A5DD-01A-12D-A27P-09  3.562644e+00  3.773066e+01  4.313237e+01</span>
<span class="co">## 100: TCGA-S3-AA17-01A-11D-A41F-09  9.349168e+01  2.892403e+01  2.042929e+01</span>
<span class="co">##                            sample          Sig1          Sig2          Sig3</span></code></pre></div>
</div>
<div id="signature-profile" class="section level3" number="5.2.2">
<h3>
<span class="header-section-number">5.2.2</span> Signature profile<a class="anchor" aria-label="anchor" href="#signature-profile"><i class="fas fa-link"></i></a>
</h3>
<p>A signature is composed of distinct component patterns. They can be shown by <code><a href="https://rdrr.io/pkg/sigminer/man/show_sig_profile.html">show_sig_profile()</a></code>. Of note, for different types of signature, the bar heights may have different meanings.</p>
<ul>
<li>SBS signatures are displayed based on the observed component frequency of the human genome, i.e., representing the relative proportions of mutations generated by each signature based on the actual trinucleotide frequencies of the reference human genome.</li>
<li>Similar to SBS signatures, copy number signatures are displayed based on the observed component frequency of the human genome. Of note, considering the count process of each feature is relatively independent, the profile is row normalized by each feature, unlike Macintyre et al. (2018) did column normalization (this method is easy to mislead readers), so the bar height can be compared within/between features.</li>
</ul>
</div>
<div id="sbs-signature-profile" class="section level3" number="5.2.3">
<h3>
<span class="header-section-number">5.2.3</span> SBS signature profile<a class="anchor" aria-label="anchor" href="#sbs-signature-profile"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_sig_profile.html">show_sig_profile</a></span><span class="op">(</span><span class="va">mt_sig</span>, mode <span class="op">=</span> <span class="st">"SBS"</span>, paint_axis_text <span class="op">=</span> <span class="cn">FALSE</span>, x_label_angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-73-1.png" width="95%"></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_sig_profile.html">show_sig_profile</a></span><span class="op">(</span><span class="va">mt_sig</span>, mode <span class="op">=</span> <span class="st">"SBS"</span>, style <span class="op">=</span> <span class="st">"cosmic"</span>, x_label_angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-74-1.png" width="95%"></div>
</div>
<div id="copy-number-signature-profile" class="section level3" number="5.2.4">
<h3>
<span class="header-section-number">5.2.4</span> Copy number signature profile<a class="anchor" aria-label="anchor" href="#copy-number-signature-profile"><i class="fas fa-link"></i></a>
</h3>
<p>For copy number signatures from tally method “W,” you have to specify the <code>normalize</code> option as “feature,” so the bar heights can be more clearly compared.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_sig_profile.html">show_sig_profile</a></span><span class="op">(</span><span class="va">sig_w</span>,
                 mode <span class="op">=</span> <span class="st">"copynumber"</span>,
                 normalize <span class="op">=</span> <span class="st">"feature"</span>,
                 method <span class="op">=</span> <span class="st">"W"</span>,
                 style <span class="op">=</span> <span class="st">"cosmic"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-75-1.png" width="95%"></div>
</div>
<div id="cosmic-signature-profile" class="section level3" number="5.2.5">
<h3>
<span class="header-section-number">5.2.5</span> COSMIC signature profile<a class="anchor" aria-label="anchor" href="#cosmic-signature-profile"><i class="fas fa-link"></i></a>
</h3>
<p>Users can show profile of COSMIC signatures by <code><a href="https://rdrr.io/pkg/sigminer/man/show_cosmic_sig_profile.html">show_cosmic_sig_profile()</a></code>.</p>
<p>To see valid signature numbers, run</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cosmic_sig_profile.html">show_cosmic_sig_profile</a></span><span class="op">(</span>sig_db <span class="op">=</span> <span class="st">"legacy"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Valid index for db 'legacy':</span>
<span class="co">## 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30</span></code></pre></div>
<blockquote>
<p>‘legacy’ is for COSMIC v2.</p>
</blockquote>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cosmic_sig_profile.html">show_cosmic_sig_profile</a></span><span class="op">(</span>sig_db <span class="op">=</span> <span class="st">"SBS"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Valid index for db 'SBS':</span>
<span class="co">## 1 2 3 4 5 6 7a 7b 7c 7d 8 9 10a 10b 11 12 13 14 15 16 17a 17b 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 84 85 86 87 88 89 90</span></code></pre></div>
<p>To show the plot, specify signature shortnames to <code>sig_index</code> option.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cosmic_sig_profile.html">show_cosmic_sig_profile</a></span><span class="op">(</span>sig_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, style <span class="op">=</span> <span class="st">"cosmic"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Valid index for db 'legacy':</span>
<span class="co">## 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-78-1.png" width="95%"></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cosmic_sig_profile.html">show_cosmic_sig_profile</a></span><span class="op">(</span>sig_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, style <span class="op">=</span> <span class="st">"cosmic"</span>, sig_db <span class="op">=</span> <span class="st">"DBS"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Valid index for db 'DBS':</span>
<span class="co">## 1 2 3 4 5 6 7 8 9 10 11</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-79-1.png" width="95%"></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_cosmic_sig_profile.html">show_cosmic_sig_profile</a></span><span class="op">(</span>sig_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, style <span class="op">=</span> <span class="st">"cosmic"</span>, sig_db <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Valid index for db 'ID':</span>
<span class="co">## 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-80-1.png" width="95%"></div>
</div>
<div id="exposure-activity-profile" class="section level3" number="5.2.6">
<h3>
<span class="header-section-number">5.2.6</span> Exposure (activity) profile<a class="anchor" aria-label="anchor" href="#exposure-activity-profile"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_sig_exposure.html">show_sig_exposure</a></span><span class="op">(</span><span class="va">mt_sig</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-81-1.png" width="95%"></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_sig_exposure.html">show_sig_exposure</a></span><span class="op">(</span><span class="va">mt_sig</span>, style <span class="op">=</span> <span class="st">"cosmic"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-82-1.png" width="95%"></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_sig_exposure.html">show_sig_exposure</a></span><span class="op">(</span><span class="va">sig_w</span>, style <span class="op">=</span> <span class="st">"cosmic"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-83-1.png" width="95%"></div>
<p>You can put group labels in the exposure profile.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/get_groups.html">get_groups</a></span><span class="op">(</span><span class="va">sig_w</span><span class="op">)</span>
<span class="co">## ℹ [2021-09-05 23:19:05]: Started.</span>
<span class="co">## ✓ [2021-09-05 23:19:05]: 'Signature' object detected.</span>
<span class="co">## ℹ [2021-09-05 23:19:05]: Obtaining clusters from the hierarchical clustering of the consensus matrix...</span>
<span class="co">## ℹ [2021-09-05 23:19:05]: Finding the dominant signature of each group...</span>
<span class="co">## =&gt; Generating a table of group and dominant signature:</span>
<span class="co">##    </span>
<span class="co">##     Sig1 Sig2</span>
<span class="co">##   1    0    2</span>
<span class="co">##   2    8    0</span>
<span class="co">## =&gt; Assigning a group to a signature with the maxium fraction (stored in 'map_table' attr)...</span>
<span class="co">## ℹ [2021-09-05 23:19:05]: Summarizing...</span>
<span class="co">##  group #1: 2 samples with Sig2 enriched.</span>
<span class="co">##  group #2: 8 samples with Sig1 enriched.</span>
<span class="co">## ! [2021-09-05 23:19:05]: The 'enrich_sig' column is set to dominant signature in one group, please check and make it consistent with biological meaning (correct it by hand if necessary).</span>
<span class="co">## ℹ [2021-09-05 23:19:05]: 0.036 secs elapsed.</span>
<span class="va">grp_label</span> <span class="op">&lt;-</span> <span class="va">grp</span><span class="op">$</span><span class="va">group</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">grp_label</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">grp</span><span class="op">$</span><span class="va">sample</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_sig_exposure.html">show_sig_exposure</a></span><span class="op">(</span><span class="va">sig_w</span>, style <span class="op">=</span> <span class="st">"cosmic"</span>, groups <span class="op">=</span> <span class="va">grp_label</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-85-1.png" width="95%"></div>
<p>Of note:</p>
<ul>
<li>For COSMIC signatures, the absolute exposure is the estimated mutation counts.</li>
<li>For copy number signatures, the absolute exposure is the estimated copy number segments.</li>
</ul>
</div>
<div id="consensus-map" class="section level3" number="5.2.7">
<h3>
<span class="header-section-number">5.2.7</span> Consensus map<a class="anchor" aria-label="anchor" href="#consensus-map"><i class="fas fa-link"></i></a>
</h3>
<p>This can only support the result from <code><a href="https://rdrr.io/pkg/sigminer/man/sig_extract.html">sig_extract()</a></code> with multiple runs.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_sig_consensusmap.html">show_sig_consensusmap</a></span><span class="op">(</span><span class="va">mt_sig</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-86-1.png" width="95%"></div>
</div>
<div id="catalogue-profile" class="section level3" number="5.2.8">
<h3>
<span class="header-section-number">5.2.8</span> Catalogue profile<a class="anchor" aria-label="anchor" href="#catalogue-profile"><i class="fas fa-link"></i></a>
</h3>
<p>Based on plot method for signature, we can plot raw catalog profile.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_catalogue.html">show_catalogue</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">mt_tally</span><span class="op">$</span><span class="va">nmf_matrix</span><span class="op">)</span>, style <span class="op">=</span> <span class="st">"cosmic"</span>, x_label_angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-87-1.png" width="95%"></div>
<p>At default, the function sums all samples. Users can specify sample ID.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/sigminer/man/show_catalogue.html">show_catalogue</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">mt_tally</span><span class="op">$</span><span class="va">nmf_matrix</span><span class="op">)</span>, style <span class="op">=</span> <span class="st">"cosmic"</span>, samples <span class="op">=</span> <span class="st">"TCGA-E9-A22E-01A-11D-A159-09"</span>, x_label_angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="sigminer_files/figure-html/unnamed-chunk-88-1.png" width="95%"></div>

</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="analysis-supps.html"><span class="header-section-number">4</span> Analysis supplements</a></div>
<div class="next"><a href="universal-analysis.html"><span class="header-section-number">6</span> Universal analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#target-vis"><span class="header-section-number">5</span> Target visualization</a></li>
<li>
<a class="nav-link" href="#copynumber-object"><span class="header-section-number">5.1</span> CopyNumber object</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#profile"><span class="header-section-number">5.1.1</span> Profile</a></li>
<li><a class="nav-link" href="#distribution"><span class="header-section-number">5.1.2</span> Distribution</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#signature-object"><span class="header-section-number">5.2</span> Signature object</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#operate-signature"><span class="header-section-number">5.2.1</span> Operate Signature</a></li>
<li><a class="nav-link" href="#signature-profile"><span class="header-section-number">5.2.2</span> Signature profile</a></li>
<li><a class="nav-link" href="#sbs-signature-profile"><span class="header-section-number">5.2.3</span> SBS signature profile</a></li>
<li><a class="nav-link" href="#copy-number-signature-profile"><span class="header-section-number">5.2.4</span> Copy number signature profile</a></li>
<li><a class="nav-link" href="#cosmic-signature-profile"><span class="header-section-number">5.2.5</span> COSMIC signature profile</a></li>
<li><a class="nav-link" href="#exposure-activity-profile"><span class="header-section-number">5.2.6</span> Exposure (activity) profile</a></li>
<li><a class="nav-link" href="#consensus-map"><span class="header-section-number">5.2.7</span> Consensus map</a></li>
<li><a class="nav-link" href="#catalogue-profile"><span class="header-section-number">5.2.8</span> Catalogue profile</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Extract, Analyze and Visualize Mutational Signatures with Sigminer</strong>" was written by Shixiang Wang, PhD (Sun Yat-sen University Cancer Center), Xue-Song Liu, PhD (ShanghaiTech University). It was last built on 2021-09-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
